(this.webpackJsonpproject=this.webpackJsonpproject||[]).push([[0],{47:function(e,t,a){},48:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){"use strict";a.r(t);var c,r,n=a(1),s=a.n(n),i=a(19),l=a.n(i),o=a(2),d=a(4),u=a(17);!function(e){e.Root="/",e.NotFound="/not-found",e.Login="/login",e.MyList="/mylist",e.Film="/films/:id",e.AddReview="/films/:id/review",e.Player="/player/:id"}(r||(r={}));var j=(c={},Object(u.a)(c,r.Film,(function(e){return r.Film.replace(":id",String(e))})),Object(u.a)(c,r.AddReview,(function(e){return r.AddReview.replace(":id",String(e))})),Object(u.a)(c,r.Player,(function(e){return r.Player.replace(":id",String(e))})),c),m=a(6),b=a(0);function f(e){var t=e.isCenter;return Object(b.jsx)("div",{className:"logo",children:Object(b.jsxs)(m.a,{to:"/",className:"logo__link".concat(t?" logo__link--light":""),children:[Object(b.jsx)("span",{className:"logo__letter logo__letter--1",children:"W"}),Object(b.jsx)("span",{className:"logo__letter logo__letter--2",children:"T"}),Object(b.jsx)("span",{className:"logo__letter logo__letter--3",children:"W"})]})})}var h,O=Object(n.memo)(f);!function(e){e.Auth="AUTH",e.NoAuth="NO_AUTH",e.Unknown="UNKNOWN"}(h||(h={}));var v,p="All genres",x=a(5),_=a.n(x),g=a(16);!function(e){e.ChangeGenre="data/changeGenre",e.LoadFilms="data/loadFilms",e.LoadFavoriteFilms="data/loadFavoriteFilms",e.UpdateFilmFavoriteStatus="data/updateFilmFavoriteStatus",e.LoadReviews="data/loadReviews",e.LoadSimilarFilms="data/loadSimilarFilms",e.LoadFilm="data/loadFilm",e.LoadPromoFilm="data/loadPromoFilm",e.ChangeShowedFilms="data/changeShowedFilms",e.RequireAuthorization="user/requireAuthorization",e.RequireLogout="user/requireLogout",e.RedirectToRoute="main/redirectToRoute"}(v||(v={}));var N,w,y=a(7),F=Object(y.b)(v.ChangeGenre,(function(e){return{payload:e}})),k=Object(y.b)(v.LoadFilms,(function(e){return{payload:{films:e}}})),S=Object(y.b)(v.LoadFavoriteFilms,(function(e){return{payload:{favoriteFilms:e}}})),C=Object(y.b)(v.UpdateFilmFavoriteStatus,(function(e,t){return{payload:{id:e,isFavorite:t}}})),L=Object(y.b)(v.LoadReviews,(function(e){return{payload:{reviews:e}}})),A=Object(y.b)(v.LoadSimilarFilms,(function(e){return{payload:{similarFilms:e}}})),P=Object(y.b)(v.LoadPromoFilm,(function(e){return{payload:{promoFilm:e}}})),R=Object(y.b)(v.LoadFilm,(function(e){return{payload:{film:e}}})),I=Object(y.b)(v.ChangeShowedFilms,(function(e){return{payload:e}})),T=Object(y.b)(v.RequireAuthorization,(function(e,t){return{payload:{authorizationStatus:e,authInfo:t}}})),D=Object(y.b)(v.RequireLogout),M=Object(y.b)(v.RedirectToRoute,(function(e){return{payload:e}})),U="what-to-watch-token",E=function(e){return{id:e.id,name:e.name,posterImage:e.poster_image,previewImage:e.preview_image,backgroundImage:e.background_image,backgroundColor:e.background_color,videoLink:e.video_link,previewVideoLink:e.preview_video_link,description:e.description,rating:e.rating,scoresCount:e.scores_count,director:e.director,starring:e.starring,runTime:e.run_time,genre:e.genre,released:e.released,isFavorite:e.is_favorite}},q=function(e){return e&&{id:e.id,name:e.name,email:e.email,avatarUrl:e.avatar_url,token:e.token}},W=a(8),z="\u041e\u0448\u0438\u0431\u043a\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0434\u0430\u043d\u043d\u044b\u0445 \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435.",G="\u041d\u0435 \u0437\u0430\u0431\u0443\u0434\u044c\u0442\u0435 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f",V=function(e){return function(){var t=Object(g.a)(_.a.mark((function t(a,c,r){var n,s;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.get("/films/".concat(e));case 3:n=t.sent,s=n.data,a(R(E(s))),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),W.b.error(z);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a,c){return t.apply(this,arguments)}}()},J=a(13),B={activeGenre:p,films:[],favoriteFilms:[],reviews:[],similarFilms:[],film:void 0,promoFilm:void 0,showedFilms:0,isDataLoaded:!1},H=Object(y.c)(B,(function(e){e.addCase(F,(function(e,t){e.activeGenre=t.payload})).addCase(k,(function(e,t){e.films=t.payload.films,e.isDataLoaded=!0})).addCase(S,(function(e,t){e.favoriteFilms=t.payload.favoriteFilms,e.isDataLoaded=!0})).addCase(R,(function(e,t){e.film=t.payload.film})).addCase(C,(function(e,t){var a,c;(null===(a=e.film)||void 0===a?void 0:a.id)===t.payload.id&&(e.film.isFavorite=t.payload.isFavorite),(null===(c=e.promoFilm)||void 0===c?void 0:c.id)===t.payload.id&&(e.promoFilm.isFavorite=t.payload.isFavorite)})).addCase(A,(function(e,t){e.similarFilms=t.payload.similarFilms})).addCase(L,(function(e,t){e.reviews=t.payload.reviews})).addCase(P,(function(e,t){e.promoFilm=t.payload.promoFilm})).addCase(I,(function(e,t){e.showedFilms=t.payload}))})),K={authorizationStatus:h.Unknown,authInfo:void 0},X=Object(y.c)(K,(function(e){e.addCase(T,(function(e,t){e.authorizationStatus=t.payload.authorizationStatus,e.authInfo=t.payload.authInfo})).addCase(D,(function(e){e.authorizationStatus=h.NoAuth,e.authInfo=void 0}))}));!function(e){e.Data="DATA",e.User="USER"}(w||(w={}));var Y=Object(J.c)((N={},Object(u.a)(N,w.Data,H),Object(u.a)(N,w.User,X),N)),Z=function(e){return e[w.User].authorizationStatus},$=function(e){return e[w.User].authInfo};var Q=function(){var e,t=Object(o.c)(Z),a=Object(o.c)($),c=Object(o.b)();return t===h.Auth?Object(b.jsxs)("ul",{className:"user-block",children:[Object(b.jsx)("li",{className:"user-block__item",children:Object(b.jsx)("div",{className:"user-block__avatar",children:Object(b.jsx)(m.a,{to:r.MyList,children:Object(b.jsx)("img",{src:null!==(e=null===a||void 0===a?void 0:a.avatarUrl)&&void 0!==e?e:"img/avatar.jpg",alt:"User avatar",width:"63",height:"63"})})})}),Object(b.jsx)("li",{className:"user-block__item",children:Object(b.jsx)("button",{className:"user-block__link",style:{border:"none",background:"none"},onClick:function(){return c(function(){var e=Object(g.a)(_.a.mark((function e(t,a,c){return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.delete("/logout");case 3:localStorage.removeItem(U),t(D()),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),W.b.error("\u041f\u0440\u0438 \u0432\u044b\u0445\u043e\u0434\u0435 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435.");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,a,c){return e.apply(this,arguments)}}())},children:"Sign out"})})]}):Object(b.jsx)("ul",{className:"user-block",children:Object(b.jsx)(m.a,{className:"user-block__link",to:r.Login,children:"Sign in"})})},ee=function(e){return e[w.Data].film},te=function(e){return e[w.Data].promoFilm||{}},ae=function(e){return e[w.Data].films},ce=function(e){return e[w.Data].favoriteFilms},re=function(e){return e[w.Data].reviews},ne=function(e){return e[w.Data].showedFilms},se=function(e){return e[w.Data].similarFilms.slice(0,4)},ie=function(e){return e[w.Data].isDataLoaded},le=function(e){return[p].concat(Array.from(new Set(e[w.Data].films.map((function(e){return e.genre})))).sort().slice(0,9))},oe=function(e){return e[w.Data].activeGenre},de=a(12);var ue=function(e){var t=e.src,a=e.poster,c=e.autoPlay,r=e.muted,s=e.width,i=e.height,l=Object(n.useState)(!1),o=Object(de.a)(l,2),d=o[0],u=o[1],j=Object(n.useRef)(null);return Object(n.useEffect)((function(){if(c){var e=setTimeout((function(){return u(!0)}),1e3);return function(){clearTimeout(e)}}}),[c]),Object(n.useEffect)((function(){null!==j.current&&(d?j.current.play():j.current.pause())}),[d]),Object(b.jsx)("video",{muted:r,poster:a,width:s,height:i,ref:j,children:Object(b.jsx)("source",{src:t})})};function je(e){var t=e.film,a=Object(n.useState)(!1),c=Object(de.a)(a,2),s=c[0],i=c[1],l=Object(o.b)();return Object(b.jsxs)("article",{className:"small-film-card catalog__films-card",onMouseMove:function(){return i(!0)},onMouseLeave:function(){return i(!1)},children:[Object(b.jsx)("div",{className:"small-film-card__image",onClick:function(){return l(M(j[r.Film](t.id)))},children:s?Object(b.jsx)(ue,{src:t.previewVideoLink,poster:t.previewImage,muted:!0,autoPlay:!0,width:"100%",height:"auto"}):Object(b.jsx)("img",{src:t.previewImage,alt:t.name,width:"280",height:"175"})}),Object(b.jsx)("h3",{className:"small-film-card__title",children:Object(b.jsx)(m.a,{className:"small-film-card__link",to:j[r.Film](t.id),children:t.name})})]})}var me=Object(n.memo)(je);var be=function(){var e=Object(o.c)(le),t=Object(o.c)(oe),a=Object(o.b)();return Object(b.jsx)("ul",{className:"catalog__genres-list",children:e.map((function(e){return Object(b.jsx)("li",{className:"catalog__genres-item".concat(e===t?" catalog__genres-item--active":""),onClick:function(){t!==e&&(a(F(e)),a(I(8)))},children:Object(b.jsx)("span",{className:"catalog__genres-link",style:{cursor:"pointer"},children:e})},e)}))})};var fe=function(e){var t=e.onClick;return Object(b.jsx)("div",{className:"catalog__more",children:Object(b.jsx)("button",{className:"catalog__button",type:"button",onClick:t,children:"Show more"})})};function he(e){var t=e.className,a=e.films,c=e.title,r=e.showGenreFilter,s=Object(o.c)(ne),i=Object(o.b)(),l=Object(o.c)(oe),d=Object(n.useMemo)((function(){return l===p?a:a.filter((function(e){return e.genre===l}))}),[l,a]);return Object(b.jsxs)("section",{className:t?"catalog ".concat(t):"catalog",children:[c?Object(b.jsx)("h2",{className:"catalog__title",children:c}):Object(b.jsx)("h2",{className:"catalog__title visually-hidden",children:"Catalog"}),r&&Object(b.jsx)(be,{}),Object(b.jsx)("div",{className:"catalog__films-list",children:d.slice(0,s).map((function(e){return Object(b.jsx)(me,{film:e},e.id)}))}),s<d.length&&Object(b.jsx)(fe,{onClick:function(){return i(I(s+8))}})]})}var Oe=Object(n.memo)(he),ve=a.p+"static/media/in-list.6d27258c.svg",pe=a.p+"static/media/add.65d2bed0.svg";var xe=function(e){var t=e.film,a=Object(o.b)();return Object(o.c)(Z)===h.Auth?Object(b.jsxs)("button",{className:"btn btn--list film-card__button",type:"button",onClick:function(){return a((e=t.id,c=!t.isFavorite,function(){var t=Object(g.a)(_.a.mark((function t(a,r,n){var s,i,l;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.post("/favorite/".concat(e,"/").concat(c?1:0));case 3:s=t.sent,i=s.data,l=E(i),a(C(l.id,l.isFavorite)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),W.b.error(z);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,a,c){return t.apply(this,arguments)}}()));var e,c},children:[t.isFavorite?Object(b.jsx)("img",{src:ve,alt:"In list"}):Object(b.jsx)("img",{src:pe,alt:"Add"}),Object(b.jsx)("span",{children:"My list"})]}):null},_e=a.p+"static/media/play-s.5fe9af5b.svg";var ge=function(e){var t=e.filmId,a=Object(o.b)(),c=Object(n.useCallback)((function(){a(M(j[r.Player](t)))}),[a,t]);return Object(b.jsxs)("button",{className:"btn btn--play film-card__button",type:"button",onClick:c,children:[Object(b.jsx)("img",{src:_e,alt:"Play"}),Object(b.jsx)("span",{children:"Play"})]})};a(47);var Ne=function(){return Object(b.jsx)("div",{className:"loading-page",children:Object(b.jsx)("div",{className:"loading"})})};function we(){var e=Object(o.c)(ie),t=Object(o.c)(te),a=Object(o.c)(ae),c=Object(o.b)();return Object(n.useEffect)((function(){(null===t||void 0===t?void 0:t.id)||c(function(){var e=Object(g.a)(_.a.mark((function e(t,a,c){var r,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.get("/promo");case 3:r=e.sent,n=r.data,t(P(E(n))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),W.b.error(z);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a,c){return e.apply(this,arguments)}}()),e||c(function(){var e=Object(g.a)(_.a.mark((function e(t,a,c){var r,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.get("/films");case 3:r=e.sent,n=r.data,t(k(n.map((function(e){return E(e)})))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),W.b.error(z);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a,c){return e.apply(this,arguments)}}())}),[c,null===t||void 0===t?void 0:t.id,e]),Object(n.useEffect)((function(){c(I(8))}),[c]),e?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("section",{className:"film-card",children:[Object(b.jsx)("div",{className:"film-card__bg",children:Object(b.jsx)("img",{src:t.backgroundImage,alt:t.name})}),Object(b.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(b.jsxs)("header",{className:"page-header film-card__head",children:[Object(b.jsx)(O,{}),Object(b.jsx)(Q,{})]}),Object(b.jsx)("div",{className:"film-card__wrap",children:Object(b.jsxs)("div",{className:"film-card__info",children:[Object(b.jsx)("div",{className:"film-card__poster",children:Object(b.jsx)("img",{src:t.posterImage,alt:"".concat(t.name," poster"),width:"218",height:"327"})}),Object(b.jsxs)("div",{className:"film-card__desc",children:[Object(b.jsx)("h2",{className:"film-card__title",children:t.name}),Object(b.jsxs)("p",{className:"film-card__meta",children:[Object(b.jsx)("span",{className:"film-card__genre",children:t.genre}),Object(b.jsx)("span",{className:"film-card__year",children:t.released})]}),Object(b.jsxs)("div",{className:"film-card__buttons",children:[Object(b.jsx)(ge,{filmId:t.id}),Object(b.jsx)(xe,{film:t})]})]})]})})]}),Object(b.jsxs)("div",{className:"page-content",children:[Object(b.jsx)(Oe,{films:a,showGenreFilter:!0}),Object(b.jsxs)("footer",{className:"page-footer",children:[Object(b.jsx)(O,{isCenter:!0}),Object(b.jsx)("div",{className:"copyright",children:Object(b.jsx)("p",{children:"\xa9 2019 What to watch Ltd."})})]})]})]}):Object(b.jsx)(Ne,{})}var ye=Object(n.memo)(we);var Fe=function(){var e=Object(o.b)(),t=Object(n.useState)(""),a=Object(de.a)(t,2),c=a[0],s=a[1],i=Object(n.useState)(""),l=Object(de.a)(i,2),d=l[0],u=l[1],j=Object(n.useState)(!1),m=Object(de.a)(j,2),f=m[0],v=m[1],p=Object(n.useMemo)((function(){return function(e){return/^\w+([.-]?\w+)*@\w+([.-]?\w+)*(\.\w{2})+$/.test(e)}(c)}),[c]),x=Object(n.useMemo)((function(){return function(e){return/[a-zA-Z]+/.test(e)&&/[0-9]+/.test(e)}(d)}),[d]);return Object(b.jsxs)("div",{className:"user-page",children:[Object(b.jsxs)("header",{className:"page-header user-page__head",children:[Object(b.jsx)(O,{}),Object(b.jsx)("h1",{className:"page-title user-page__title",children:"Sign in"})]}),Object(b.jsx)("div",{className:"sign-in user-page__content",children:Object(b.jsxs)("form",{action:"#",className:"sign-in__form",onSubmit:function(t){t.preventDefault(),v(!0),p&&x&&e(function(e){var t=e.email,a=e.password;return function(){var e=Object(g.a)(_.a.mark((function e(c,n,s){var i,l,o;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.post("/login",{email:t,password:a});case 3:i=e.sent,l=i.data,(o=q(l))&&(n=o.token,localStorage.setItem(U,n),c(T(h.Auth,o))),c(M(r.Root)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),W.b.info("\u041f\u0440\u0438 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438 \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430. \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u043f\u043e\u0437\u0436\u0435.");case 13:case"end":return e.stop()}var n}),e,null,[[0,10]])})));return function(t,a,c){return e.apply(this,arguments)}}()}({email:c,password:d}))},children:[f&&!p&&Object(b.jsx)("div",{className:"sign-in__message",children:Object(b.jsx)("p",{children:"Please enter a valid email address"})}),f&&!x&&Object(b.jsx)("div",{className:"sign-in__message",children:Object(b.jsx)("p",{children:"Please enter a valid password"})}),Object(b.jsxs)("div",{className:"sign-in__fields",children:[Object(b.jsxs)("div",{className:"sign-in__field ".concat(f&&!p&&"sign-in__field--error"),children:[Object(b.jsx)("input",{className:"sign-in__input",type:"email",placeholder:"Email address",name:"user-email",id:"user-email",defaultValue:c,onChange:function(e){return s(e.target.value)}}),Object(b.jsx)("label",{className:"sign-in__label visually-hidden",htmlFor:"user-email",children:"Email address"})]}),Object(b.jsxs)("div",{className:"sign-in__field ".concat(f&&!x&&"sign-in__field--error"),children:[Object(b.jsx)("input",{className:"sign-in__input",type:"password",placeholder:"Password",name:"user-password",id:"user-password",defaultValue:d,onChange:function(e){return u(e.target.value)}}),Object(b.jsx)("label",{className:"sign-in__label visually-hidden",htmlFor:"user-password",children:"Password"})]})]}),Object(b.jsx)("div",{className:"sign-in__submit",children:Object(b.jsx)("button",{className:"sign-in__btn",type:"submit",children:"Sign in"})})]})}),Object(b.jsxs)("footer",{className:"page-footer",children:[Object(b.jsx)(O,{isCenter:!0}),Object(b.jsx)("div",{className:"copyright",children:Object(b.jsx)("p",{children:"\xa9 2019 What to watch Ltd."})})]})]})};var ke=function(){var e=Object(o.c)(ie),t=Object(o.c)(ce),a=Object(o.b)();return Object(n.useEffect)((function(){e||a(function(){var e=Object(g.a)(_.a.mark((function e(t,a,c){var r,n;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.get("/favorite");case 3:r=e.sent,n=r.data,t(S(n.map((function(e){return E(e)})))),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),W.b.error(z);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,a,c){return e.apply(this,arguments)}}())}),[a,e]),Object(n.useEffect)((function(){a(I(8))}),[a]),Object(b.jsxs)("div",{className:"user-page",children:[Object(b.jsxs)("header",{className:"page-header user-page__head",children:[Object(b.jsx)(O,{}),Object(b.jsx)("h1",{className:"page-title user-page__title",children:"My list"}),Object(b.jsx)(Q,{})]}),Object(b.jsx)(Oe,{films:t}),Object(b.jsxs)("footer",{className:"page-footer",children:[Object(b.jsx)(O,{isCenter:!0}),Object(b.jsx)("div",{className:"copyright",children:Object(b.jsx)("p",{children:"\xa9 2019 What to watch Ltd."})})]})]})},Se=["January","February","March","April","May","June","July","August","September","October","November","December"],Ce=function(e){return String(e).padStart(2,"0")},Le=function(e){var t=Math.floor(e/3600),a=Math.floor(e%3600/60),c=Math.floor(e%60);return 0===t&&0===a&&0===c?"00:00":t>0?"-".concat(Ce(t),":").concat(Ce(a),":").concat(Ce(c)):"-".concat(Ce(a),":").concat(Ce(c))},Ae=function(e){var t=function(e){return{hours:Math.floor(e/60),minutes:e%60}}(e),a=t.hours,c=t.minutes;return a>0?"".concat(a,"h ").concat(c,"m"):"".concat(c,"m")},Pe=function(e){"string"===typeof e&&(e=new Date(e));var t=e.getMonth(),a=e.getDate(),c=e.getFullYear();return"".concat(Se[t]," ").concat(a,", ").concat(c)};var Re=function(e){var t=e.film;return Object(b.jsxs)("div",{className:"film-card__text film-card__row",children:[Object(b.jsxs)("div",{className:"film-card__text-col",children:[Object(b.jsxs)("p",{className:"film-card__details-item",children:[Object(b.jsx)("strong",{className:"film-card__details-name",children:"Director"}),Object(b.jsx)("span",{className:"film-card__details-value",children:t.director})]}),Object(b.jsxs)("p",{className:"film-card__details-item",children:[Object(b.jsx)("strong",{className:"film-card__details-name",children:"Starring"}),Object(b.jsx)("span",{className:"film-card__details-value",children:t.starring.join(",#").split("#").map((function(e){return Object(b.jsxs)("span",{children:[e," "]},e)}))})]})]}),Object(b.jsxs)("div",{className:"film-card__text-col",children:[Object(b.jsxs)("p",{className:"film-card__details-item",children:[Object(b.jsx)("strong",{className:"film-card__details-name",children:"Run Time"}),Object(b.jsx)("span",{className:"film-card__details-value",children:Ae(t.runTime)})]}),Object(b.jsxs)("p",{className:"film-card__details-item",children:[Object(b.jsx)("strong",{className:"film-card__details-name",children:"Genre"}),Object(b.jsx)("span",{className:"film-card__details-value",children:t.genre})]}),Object(b.jsxs)("p",{className:"film-card__details-item",children:[Object(b.jsx)("strong",{className:"film-card__details-name",children:"Released"}),Object(b.jsx)("span",{className:"film-card__details-value",children:t.released})]})]})]})};var Ie=function(e){var t,a=e.film,c=Object(n.useMemo)((function(){return a.rating<3?"Bad":a.rating<5?"Normal":a.rating<8?"Good":a.rating<10?"Very good":"Awesome"}),[a.rating]);return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("div",{className:"film-rating",children:[Object(b.jsx)("div",{className:"film-rating__score",children:a.rating}),Object(b.jsxs)("p",{className:"film-rating__meta",children:[Object(b.jsx)("span",{className:"film-rating__level",children:c}),Object(b.jsxs)("span",{className:"film-rating__count",children:[a.scoresCount," ratings"]})]})]}),Object(b.jsxs)("div",{className:"film-card__text",children:[Object(b.jsx)("p",{children:a.description}),Object(b.jsx)("p",{className:"film-card__director",children:Object(b.jsxs)("strong",{children:["Director: ",a.director]})}),Object(b.jsx)("p",{className:"film-card__starring",children:Object(b.jsxs)("strong",{children:["Starring: ",(t=a.starring,t.length>4?"".concat(t.slice(0,4).join(", ")," and other"):t.join(", "))]})})]})]})};var Te=function(e){var t=e.reviews,a=Math.round(t.length/2),c=t.slice(0,a),r=t.slice(a);return Object(b.jsxs)("div",{className:"film-card__reviews film-card__row",children:[Object(b.jsx)("div",{className:"film-card__reviews-col",children:c.map((function(e){return Object(b.jsxs)("div",{className:"review",children:[Object(b.jsxs)("blockquote",{className:"review__quote",children:[Object(b.jsx)("p",{className:"review__text",children:e.comment}),Object(b.jsxs)("footer",{className:"review__details",children:[Object(b.jsx)("cite",{className:"review__author",children:e.user.name}),Object(b.jsx)("time",{className:"review__date",dateTime:e.date,children:Pe(e.date)})]})]}),Object(b.jsx)("div",{className:"review__rating",children:e.rating})]},e.id)}))}),Object(b.jsx)("div",{className:"film-card__reviews-col",children:r.map((function(e){return Object(b.jsxs)("div",{className:"review",children:[Object(b.jsxs)("blockquote",{className:"review__quote",children:[Object(b.jsx)("p",{className:"review__text",children:e.comment}),Object(b.jsxs)("footer",{className:"review__details",children:[Object(b.jsx)("cite",{className:"review__author",children:e.user.name}),Object(b.jsx)("time",{className:"review__date",dateTime:e.date,children:Pe(e.date)})]})]}),Object(b.jsx)("div",{className:"review__rating",children:e.rating})]},e.id)}))})]})};var De=function(e){var t=e.film,a=e.reviews,c=Object(d.g)(),r=c.hash||"#overview";return Object(b.jsxs)("div",{className:"film-card__desc",children:[Object(b.jsx)("nav",{className:"film-nav film-card__nav",children:Object(b.jsxs)("ul",{className:"film-nav__list",children:[Object(b.jsx)("li",{className:"film-nav__item".concat("#overview"===r?" film-nav__item--active":""),children:Object(b.jsx)(m.a,{to:"".concat(c.pathname,"#overview"),className:"film-nav__link",children:"Overview"})}),Object(b.jsx)("li",{className:"film-nav__item".concat("#details"===r?" film-nav__item--active":""),children:Object(b.jsx)(m.a,{to:"".concat(c.pathname,"#details"),className:"film-nav__link",children:"Details"})}),Object(b.jsx)("li",{className:"film-nav__item".concat("#reviews"===r?" film-nav__item--active":""),children:Object(b.jsx)(m.a,{to:"".concat(c.pathname,"#reviews"),className:"film-nav__link",children:"Reviews"})})]})}),function(){switch(r){case"#overview":return Object(b.jsx)(Ie,{film:t});case"#details":return Object(b.jsx)(Re,{film:t});case"#reviews":return Object(b.jsx)(Te,{reviews:a})}}()]})};var Me=function(){var e=parseInt(Object(d.h)().id,10),t=Object(o.c)(Z),a=Object(o.c)(ee),c=Object(o.c)(re),r=Object(o.c)(se),s=Object(o.b)();return Object(n.useEffect)((function(){e&&e!==(null===a||void 0===a?void 0:a.id)&&(s(V(e)),s(function(e){return function(){var t=Object(g.a)(_.a.mark((function t(a,c,r){var n,s;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.get("/films/".concat(e,"/similar"));case 3:n=t.sent,s=n.data,a(A(s.map((function(e){return E(e)})).filter((function(t){return t.id!==e})))),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),W.b.error(z);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a,c){return t.apply(this,arguments)}}()}(e)),s(function(e){return function(){var t=Object(g.a)(_.a.mark((function t(a,c,r){var n,s;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,r.get("/comments/".concat(e));case 3:n=t.sent,s=n.data,a(L(s)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),W.b.error(z);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,a,c){return t.apply(this,arguments)}}()}(e)))}),[s,e,null===a||void 0===a?void 0:a.id]),Object(n.useEffect)((function(){s(I(8))}),[s,e]),a?Object(b.jsxs)(b.Fragment,{children:[Object(b.jsxs)("section",{className:"film-card film-card--full",children:[Object(b.jsxs)("div",{className:"film-card__hero",children:[Object(b.jsx)("div",{className:"film-card__bg",children:Object(b.jsx)("img",{src:a.backgroundImage,alt:a.name})}),Object(b.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(b.jsxs)("header",{className:"page-header film-card__head",children:[Object(b.jsx)(O,{}),Object(b.jsx)(Q,{})]}),Object(b.jsx)("div",{className:"film-card__wrap",children:Object(b.jsxs)("div",{className:"film-card__desc",children:[Object(b.jsx)("h2",{className:"film-card__title",children:a.name}),Object(b.jsxs)("p",{className:"film-card__meta",children:[Object(b.jsx)("span",{className:"film-card__genre",children:a.genre}),Object(b.jsx)("span",{className:"film-card__year",children:a.released})]}),Object(b.jsxs)("div",{className:"film-card__buttons",children:[Object(b.jsx)(ge,{filmId:a.id}),Object(b.jsx)(xe,{film:a}),t===h.Auth&&Object(b.jsx)(m.a,{to:"/films/".concat(e,"/review"),className:"btn film-card__button",children:"Add review"})]})]})})]}),Object(b.jsx)("div",{className:"film-card__wrap film-card__translate-top",children:Object(b.jsxs)("div",{className:"film-card__info",children:[Object(b.jsx)("div",{className:"film-card__poster film-card__poster--big",children:Object(b.jsx)("img",{src:a.posterImage,alt:a.name,width:"218",height:"327"})}),Object(b.jsx)(De,{film:a,reviews:c})]})})]}),Object(b.jsxs)("div",{className:"page-content",children:[Object(b.jsx)(Oe,{className:"catalog--like-this",title:"More like this",films:r}),Object(b.jsxs)("footer",{className:"page-footer",children:[Object(b.jsx)(O,{isCenter:!0}),Object(b.jsx)("div",{className:"copyright",children:Object(b.jsx)("p",{children:"\xa9 2019 What to watch Ltd."})})]})]})]}):Object(b.jsx)(Ne,{})};function Ue(e){var t=e.filmId,a=Object(n.useState)(5),c=Object(de.a)(a,2),r=c[0],s=c[1],i=Object(n.useState)(""),l=Object(de.a)(i,2),d=l[0],u=l[1],j=Object(n.useRef)(null),m=Object(o.b)(),f=Object(n.useMemo)((function(){return r>0&&d.length>=50&&d.length<=400}),[r,d]);return Object(b.jsx)("div",{className:"add-review",children:Object(b.jsxs)("form",{action:"#",className:"add-review__form",onSubmit:function(e){var a,c,n;e.preventDefault(),f&&(j.current&&(j.current.disabled=!0),m((a=t,c={rating:r,comment:d},n=function(e){e?(s(5),u("")):j.current&&(j.current.disabled=!1)},function(){var e=Object(g.a)(_.a.mark((function e(t,r,s){var i,l;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s.post("/comments/".concat(a),c);case 3:i=e.sent,l=i.data,t(L(l)),W.b.info("\u041e\u0442\u0437\u044b\u0432 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d"),n(!0),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),W.b.error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0435 \u043e\u0442\u0437\u044b\u0432\u0430."),n(!1);case 14:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t,a,c){return e.apply(this,arguments)}}())))},children:[Object(b.jsx)("div",{className:"rating",children:Object(b.jsx)("div",{className:"rating__stars",children:Array.from({length:10},(function(e,t){return t+1})).reverse().map((function(e){return[Object(b.jsx)("input",{className:"rating__input",id:"star-".concat(e),type:"radio",name:"rating",value:e,checked:r===e,onChange:function(){return s(e)}},"input-".concat(e)),Object(b.jsxs)("label",{className:"rating__label",htmlFor:"star-".concat(e),children:["Rating ",e]},"label-".concat(e))]}))})}),Object(b.jsxs)("div",{className:"add-review__text",children:[Object(b.jsx)("textarea",{className:"add-review__textarea",placeholder:"Review text",maxLength:400,value:d,onChange:function(e){return u(e.target.value)}}),Object(b.jsx)("div",{className:"add-review__submit",children:Object(b.jsx)("button",{ref:j,className:"add-review__btn",type:"submit",disabled:!f,children:"Post"})})]})]})})}var Ee=function(){var e=parseInt(Object(d.h)().id,10),t=Object(o.c)(ee),a=Object(o.b)();return Object(n.useEffect)((function(){e&&e!==(null===t||void 0===t?void 0:t.id)&&a(V(e))}),[a,e,null===t||void 0===t?void 0:t.id]),t?Object(b.jsxs)("section",{className:"film-card film-card--full",children:[Object(b.jsxs)("div",{className:"film-card__header",children:[Object(b.jsx)("div",{className:"film-card__bg",children:Object(b.jsx)("img",{src:t.backgroundImage,alt:t.name})}),Object(b.jsx)("h1",{className:"visually-hidden",children:"WTW"}),Object(b.jsxs)("header",{className:"page-header",children:[Object(b.jsx)(O,{}),Object(b.jsx)("nav",{className:"breadcrumbs",children:Object(b.jsxs)("ul",{className:"breadcrumbs__list",children:[Object(b.jsx)("li",{className:"breadcrumbs__item",children:Object(b.jsx)(m.a,{className:"breadcrumbs__link",to:j[r.Film](e),children:t.name})}),Object(b.jsx)("li",{className:"breadcrumbs__item",children:Object(b.jsx)("span",{className:"breadcrumbs__link",children:"Add review"})})]})}),Object(b.jsx)(Q,{})]}),Object(b.jsx)("div",{className:"film-card__poster film-card__poster--small",children:Object(b.jsx)("img",{src:t.posterImage,alt:t.name,width:"218",height:"327"})})]}),Object(b.jsx)(Ue,{filmId:t.id})]}):Object(b.jsx)(Ne,{})},qe=a(18),We=function(e){var t=Object(n.useState)({isPlaying:!1,progress:0,timeElapsed:0}),a=Object(de.a)(t,2),c=a[0],r=a[1];Object(n.useEffect)((function(){var t,a;c.isPlaying?null===e||void 0===e||null===(t=e.current)||void 0===t||t.play():null===e||void 0===e||null===(a=e.current)||void 0===a||a.pause()}),[c.isPlaying,e]);return{playerState:c,togglePlay:function(){r(Object(qe.a)(Object(qe.a)({},c),{},{isPlaying:!c.isPlaying}))},handleOnTimeUpdate:function(){if(null===e||void 0===e?void 0:e.current){var t=e.current.currentTime/e.current.duration*100,a=e.current.duration-e.current.currentTime;r(Object(qe.a)(Object(qe.a)({},c),{},{progress:t,timeElapsed:a}))}},handleVideoProgress:function(t){if(null===e||void 0===e?void 0:e.current){e.current.currentTime=e.current.duration/100*t;var a=e.current.duration-e.current.currentTime;r(Object(qe.a)(Object(qe.a)({},c),{},{progress:t,timeElapsed:a}))}},requestFullscreen:function(){var t;null===(t=e.current)||void 0===t||t.requestFullscreen()}}},ze=a.p+"static/media/full-screen.a2880dd8.svg",Ge=a.p+"static/media/pause.aba5f783.svg";var Ve=function(){var e=parseInt(Object(d.h)().id,10),t=Object(o.c)(ee),a=Object(n.useRef)(null),c=We(a),s=c.playerState,i=c.togglePlay,l=c.requestFullscreen,u=c.handleOnTimeUpdate,m=c.handleVideoProgress,f=Object(o.b)();return Object(n.useEffect)((function(){e&&e!==(null===t||void 0===t?void 0:t.id)&&f(V(e))}),[f,e,null===t||void 0===t?void 0:t.id]),t?Object(b.jsxs)("div",{className:"player",children:[Object(b.jsx)("video",{className:"player__video",poster:t.previewImage,ref:a,onTimeUpdate:u,children:Object(b.jsx)("source",{src:t.videoLink})}),Object(b.jsx)("button",{type:"button",className:"player__exit",onClick:function(){f(M(j[r.Film](e)))},children:"Exit"}),Object(b.jsxs)("div",{className:"player__controls",children:[Object(b.jsxs)("div",{className:"player__controls-row",children:[Object(b.jsxs)("div",{className:"player__time",onClick:function(e){var t=e.clientX-e.currentTarget.offsetLeft,a=e.currentTarget.clientWidth,c=Math.floor(t/a*100);m(c)},children:[Object(b.jsx)("progress",{className:"player__progress",value:s.progress,max:"100"}),Object(b.jsx)("div",{className:"player__toggler",style:{left:"".concat(s.progress,"%")},children:"Toggler"})]}),Object(b.jsx)("div",{className:"player__time-value",children:Le(s.timeElapsed)})]}),Object(b.jsxs)("div",{className:"player__controls-row",children:[Object(b.jsxs)("button",{type:"button",className:"player__play",onClick:function(){return i()},children:[s.isPlaying?Object(b.jsx)("img",{src:Ge,alt:"Pause"}):Object(b.jsx)("img",{src:_e,alt:"Play"}),Object(b.jsx)("span",{children:s.isPlaying?"Pause":"Play"})]}),Object(b.jsx)("div",{className:"player__name",children:t.name}),Object(b.jsxs)("button",{type:"button",className:"player__full-screen",onClick:function(){return l()},children:[Object(b.jsx)("img",{src:ze,alt:"Full screen"}),Object(b.jsx)("span",{children:"Full screen"})]})]})]})]}):Object(b.jsx)(Ne,{})};a(48);var Je=function(){return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(m.a,{className:"link-return-url",to:"/",children:"Return to main"}),Object(b.jsxs)("div",{className:"flex-center position-r full-height",children:[Object(b.jsx)("div",{className:"code",children:"404"}),Object(b.jsx)("div",{className:"message",style:{padding:"10px"},children:"NOT FOUND"})]})]})};var Be=function(e){var t=e.exact,a=e.path,c=e.render,n=Object(o.c)(Z);return Object(b.jsx)(d.b,{exact:t,path:a,render:function(e){return n===h.Auth?c(e):Object(b.jsx)(d.a,{to:r.Login})}})};var He,Ke=function(){return function(e){return e===h.Unknown}(Object(o.c)(Z))?Object(b.jsx)(Ne,{}):Object(b.jsxs)(d.d,{children:[Object(b.jsx)(d.b,{exact:!0,path:r.Root,children:Object(b.jsx)(ye,{})}),Object(b.jsx)(d.b,{exact:!0,path:r.Login,children:Object(b.jsx)(Fe,{})}),Object(b.jsx)(Be,{exact:!0,path:r.MyList,render:function(){return Object(b.jsx)(ke,{})}}),Object(b.jsx)(d.b,{exact:!0,path:r.Film,children:Object(b.jsx)(Me,{})}),Object(b.jsx)(Be,{exact:!0,path:r.AddReview,render:function(){return Object(b.jsx)(Ee,{})}}),Object(b.jsx)(d.b,{exact:!0,path:r.Player,children:Object(b.jsx)(Ve,{})}),Object(b.jsx)(d.b,{exact:!0,path:r.NotFound,children:Object(b.jsx)(Je,{})}),Object(b.jsx)(d.b,{children:Object(b.jsx)(Je,{})})]})},Xe=a(35),Ye=a.n(Xe);!function(e){e[e.Unauthorized=401]="Unauthorized",e[e.NotFound=404]="NotFound"}(He||(He={}));var Ze=a(10),$e=Object(Ze.a)(),Qe=function(e){return function(e){return function(t){return t.type===v.RedirectToRoute&&$e.push(t.payload),e(t)}}},et=(a(67),a(68),function(e,t){var a=Ye.a.create({baseURL:"https://8.react.pages.academy/wtw",timeout:5e3});return a.interceptors.response.use((function(e){return e}),(function(a){var c=a.response;return(null===c||void 0===c?void 0:c.status)===He.Unauthorized?e():((null===c||void 0===c?void 0:c.status)===He.NotFound&&t(),Promise.reject(a))})),a.interceptors.request.use((function(e){var t=function(){var e=localStorage.getItem(U);return null!==e&&void 0!==e?e:""}();return t&&(e.headers["x-token"]=t),e})),a}((function(){return tt.dispatch(T(h.NoAuth))}),(function(){return tt.dispatch(M(r.NotFound))}))),tt=Object(y.a)({reducer:Y,middleware:function(e){return e({thunk:{extraArgument:et}}).concat(Qe)}});tt.dispatch(function(){var e=Object(g.a)(_.a.mark((function e(t,a,c){var r,n,s,i;return _.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.get("/login");case 3:r=e.sent,n=r.data,s=q(n),i=s?h.Auth:h.NoAuth,t(T(i,s)),i!==h.Auth&&W.b.info(G),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),W.b.info(G);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,a,c){return e.apply(this,arguments)}}()),l.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(o.a,{store:tt,children:Object(b.jsxs)(d.c,{history:$e,children:[Object(b.jsx)(W.a,{}),Object(b.jsx)(Ke,{})]})})}),document.getElementById("root"))}},[[69,1,2]]]);
//# sourceMappingURL=main.48babc8b.chunk.js.map